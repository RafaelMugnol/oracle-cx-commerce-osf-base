/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

const logger = require('@oracle-cx-commerce/logger/cli');
const {loadAppConfig, createApplicationConfig} = require('@oracle-cx-commerce/cli-shared');
const {getApplicationDir, assertFolderExistSync} = require('@oracle-cx-commerce/tools-util');
const path = require('path');
const {___} = require('@oracle-cx-commerce/tools-i18n').i18n({directory: require('path').join(__dirname, './locales')});

/*
 *  This command will create/update config/app-config/index.js with app configuration
 */
module.exports = (appName, options) => {
  if (options.list) {
    const str = JSON.stringify(loadAppConfig(appName), null, 2); // spacing level = 2
    logger.info(`${str}`);

    return;
  }
  // Check app directory is accessible.
  assertFolderExistSync(
    path.resolve(getApplicationDir(appName)),
    ___`Cannot access application folder: ${path.resolve(getApplicationDir(appName))}`
  );

  createApplicationConfig(appName, options);

  // logger.info(___`Created configuration for application ${appName}:`);
  // display the config after the update
  // const str = JSON.stringify(loadWorkspaceConfig(appName), null, 2); // spacing level = 2
  // logger.info(`${str}`);
};
