/*
 ** Copyright (c) 2021 Oracle and/or its affiliates.
 */

// Matches any absolute path
const DEFAULT_FILTER = /^\/.*\.*$/;

const DEFAULT_KIND = /^url-token$/;

module.exports = (options = {}) => ({
  name: 'occ-externalize',

  setup(build) {
    const {filter = DEFAULT_FILTER, kind = DEFAULT_KIND} = options;

    build.onResolve({filter}, args => {
      if (kind.test(args.kind)) {
        return {
          path: args.path,
          external: true
        };
      }
    });
  }
});
