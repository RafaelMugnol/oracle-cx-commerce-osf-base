/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {createEndpoint} from '@oracle-cx-commerce/endpoints/factory';

export const processInput = ({level = 'error', message}, state) => {
  console.assert(['error', 'warn', 'info', 'debug'].includes(level), `Invalid value for level "${level}"`);

  // TODO Restore the below when the info is in the state
  // const {visitorId = '', visitId = ''} = getVisitorSession(state);
  const {visitorId = '', visitId = ''} = state;

  return {
    body: {
      logLevel: level,
      messages: [{LogData: `[${level}] ${message}, ${visitId}, ${visitorId}`}]
    }
  };
};

export default createEndpoint('log', {
  processInput
});
