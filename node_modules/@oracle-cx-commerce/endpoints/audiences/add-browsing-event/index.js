/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {createEndpoint} from '@oracle-cx-commerce/endpoints/factory';

// This endpoint should only be called from the context of a product or collection page view.  The add-browsing-event subscriber
// tracks state changes and calls this endpoint in those contexts with the appropriate payload.  These asserts are here in case
// this endpoint gets called from somewhere else.
export const processInput = payload => {
  console.assert(payload.pageView, 'Missing argument "pageView" for endpoint "addBrowsingEvent"');
  console.assert(payload.pageView.catalogId, 'Missing argument "pageView.catalogId" for endpoint "addBrowsingEvent"');
  console.assert(payload.pageView.id, 'Missing argument "pageView.id" for endpoint "addBrowsingEvent"');
  console.assert(payload.pageView.type, 'Missing argument "pageView.type" for endpoint "addBrowsingEvent"');
  /*console.assert(
    payload.pageView.type === 'PRODUCT' || payload.pageView.type === 'COLLECTION',
    'Type must be PRODUCT or COLLECTION.'
  );*/

  return {
    body: payload
  };
};

export default createEndpoint('addBrowsingEvent', {
  processInput
});
