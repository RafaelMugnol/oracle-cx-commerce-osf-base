/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {getEndpoints} from '@oracle-cx-commerce/commerce-utils/selector';
import {updateCatalog} from '@oracle-cx-commerce/endpoints/utils/endpoint-factory/transform-catalog-es6';

const getSwaggerApiCatalog = async ({fetchApiCatalog, state, endpointId}) => {
  let catalog = {...getEndpoints(state)};

  if (!catalog[endpointId]) {
    const rawCatalogs = await fetchApiCatalog();

    for (const rawCatalog of rawCatalogs) {
      catalog = updateCatalog(catalog, rawCatalog);
    }
  }

  return catalog;
};

export default getSwaggerApiCatalog;
