/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import React from 'react';
import Styled from '@oracle-cx-commerce/react-components/styled';
import QuoteNote from '@oracle-cx-commerce/react-widgets/profile/profile-quote-notes-history/components/quote-note';
import css from '@oracle-cx-commerce/react-widgets/profile/profile-quote-notes-history/styles.css';
import {connect} from '@oracle-cx-commerce/react-components/provider';
import {getComponentData} from '@oracle-cx-commerce/react-widgets/profile/profile-quote-notes-history/selectors';
import PropTypes from 'prop-types';

/**
 * Widget that displays the option to Approve or Reject a Pending Approval Order/scheduled Order.
 *
 * @param props
 */
const ProfileQuoteNotesHistory = props => {
  //resources
  const {currentOrder = {}, textQuoteNotes} = props;
  const getSortedNote = () => {
    if (currentOrder.quoteInfo && currentOrder.quoteInfo.notes) {
      return currentOrder.quoteInfo.notes.sort((a, b) => {
        return new Date(a.requestDate || a.quoteDate) - new Date(b.requestDate || b.quoteDate);
      });
    }

    return [];
  };

  return (
    <Styled id="ProfileQuoteNotesHistory" css={css}>
      {currentOrder.quoteInfo && (
        <div className="ProfileQuoteNotesHistory">
          <h3>{textQuoteNotes}</h3>
          <div className="ProfileQuoteNotesHistory__NotesHistory">
            <div className="ProfileQuoteNotesHistory__NotesContainer">
              {getSortedNote().map(note => (
                <QuoteNote key={note.requestDate || note.quoteDate} note={note} {...props} />
              ))}
            </div>
          </div>
        </div>
      )}
    </Styled>
  );
};

ProfileQuoteNotesHistory.propTypes = {
  /**
   * Current order details
   */
  currentOrder: PropTypes.object.isRequired,
  /**
   * A resource string to display quote notes
   */
  textQuoteNotes: PropTypes.string.isRequired
};

ProfileQuoteNotesHistory.defaultProps = {};

export default connect(getComponentData)(ProfileQuoteNotesHistory);
