/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import React, {useState, useContext} from 'react';
import Styled from '@oracle-cx-commerce/react-components/styled';
import RegistrationStatusDropdown from '@oracle-cx-commerce/react-widgets/profile/contact-registration-detail/components/registration-status-dropdown';
import UpdateRegistationRequest from '@oracle-cx-commerce/react-widgets/profile/contact-registration-detail/components/update-registration-request';
import {RegistrationRequestContext} from '@oracle-cx-commerce/react-ui/contexts';
import PropTypes from 'prop-types';

/**
 * This component is used to display the contact registration actions like
 * registration status drop down and save and cancel button
 */
const ContactRegistrationActions = props => {
  //registrationRequestContext context
  const contactRequest = useContext(RegistrationRequestContext);

  const [selectedRegistrationStatus, setSelectedRegistrationStatus] = useState(
    contactRequest ? contactRequest.status : ''
  );

  const isRejected = () => {
    if (selectedRegistrationStatus === 'rejected') {
      return true;
    }

    return false;
  };
  /**
   * This method takes the status value and opens a modal if the status value is accept or reject.
   * @param {*} status
   */
  const handleStatusChange = status => {
    setSelectedRegistrationStatus(status);
  };

  return (
    <Styled id="ContactRegistrationActions">
      <>
        {!isRejected() && (
          <RegistrationStatusDropdown
            selectedRegistrationStatus={selectedRegistrationStatus}
            onRegistrationStatusChange={handleStatusChange}
            {...props}
          />
        )}
        <UpdateRegistationRequest selectedRegistrationStatus={selectedRegistrationStatus} {...props} />
      </>
    </Styled>
  );
};

ContactRegistrationActions.propTypes = {
  /**
   * The string to display the registration status
   */
  selectedRegistrationStatus: PropTypes.string
};

ContactRegistrationActions.defaultProps = {
  selectedRegistrationStatus: ''
};
export default ContactRegistrationActions;
