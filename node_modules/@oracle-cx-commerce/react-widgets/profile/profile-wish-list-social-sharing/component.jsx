/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import React, {Suspense, useState} from 'react';

import Popover from '@oracle-cx-commerce/react-components/popover';
import ShareIcon from '@oracle-cx-commerce/react-components/icons/social-sharing';
import Styled from '@oracle-cx-commerce/react-components/styled';
import css from '@oracle-cx-commerce/react-widgets/profile/profile-wish-list-social-sharing/styles.css';

const ProfileWishListSocialSharingPortal = React.lazy(() =>
  import(
    '@oracle-cx-commerce/react-widgets/profile/profile-wish-list-social-sharing/components/profile-wish-list-social-sharing-portal'
  )
);

/**
 * Displays Wishlist Social sharing icons to share a wishlist on social media
 */
const ProfileWishListSocialSharing = props => {
  const {
    actionShare,
    headingShareThisVia,
    closeLinkAltText,
    displayFacebook = true,
    displayPinterest = true,
    displayTwitter = true,
    displayEmail = true
  } = props;

  const [showShareOptions, setShowShareOptions] = useState(false);
  const displaySocialShareLink = displayFacebook || displayPinterest || displayTwitter || displayEmail;

  return (
    <Styled id="ProfileWishListSocialSharing" css={css}>
      {displaySocialShareLink && (
        <div className="ProfileWishListSocialSharing">
          <button
            className="ProfileWishListSocialSharing__Button"
            onClick={() => setShowShareOptions(!showShareOptions)}
            type="button"
            aria-label={actionShare}
          >
            <ShareIcon />
            <span className="ProfileWishListSocialSharing__ShareText">{actionShare}</span>
          </button>

          {showShareOptions && typeof window !== 'undefined' && (
            <Suspense fallback={null}>
              <Popover
                show={showShareOptions}
                title={headingShareThisVia}
                onClose={() => setShowShareOptions(false)}
                closeIconTitle={closeLinkAltText}
                closeAriaLabel={closeLinkAltText}
              >
                <ProfileWishListSocialSharingPortal {...props} />
              </Popover>
            </Suspense>
          )}
        </div>
      )}
    </Styled>
  );
};

export default ProfileWishListSocialSharing;
