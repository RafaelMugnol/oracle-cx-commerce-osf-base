/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */
import React, {useMemo} from 'react';

import Card from '@oracle-cx-commerce/react-components/card';
import {PAGE_SCHEDULED_ORDER_DETAILS_LINK} from '@oracle-cx-commerce/commerce-utils/constants';
import ScheduledOrderDetailSummary from '@oracle-cx-commerce/react-widgets/profile/scheduled-order-history/components/scheduled-order-detail-summary';
import Styled from '@oracle-cx-commerce/react-components/styled';
import css from '@oracle-cx-commerce/react-widgets/profile/scheduled-order-history/components/profile-scheduled-order/styles.css';
import {getScheduledOrder} from '@oracle-cx-commerce/commerce-utils/selector';
import {isEmptyObject} from '@oracle-cx-commerce/utils/generic';
import {useNavigator} from '@oracle-cx-commerce/react-components/link';
import {useSelector} from '@oracle-cx-commerce/react-components/provider';

const ProfileScheduledOrder = props => {
  const {itemId} = props;
  const scheduledOrderInfo = useSelector(getScheduledOrder, {id: itemId}) || {};
  const goToPage = useNavigator();

  return (
    <>
      {useMemo(
        () => (
          <Styled id="ProfileScheduledOrder" css={css}>
            {!isEmptyObject(scheduledOrderInfo) && (
              <Card key={itemId} className="ProfileScheduledOrder__Card">
                <div
                  onClick={() => goToPage(`${PAGE_SCHEDULED_ORDER_DETAILS_LINK}/${itemId}`)}
                  onKeyPress={event =>
                    event.key === 'Enter' ? goToPage(`${PAGE_SCHEDULED_ORDER_DETAILS_LINK}/${itemId}`) : ''
                  }
                  role="button"
                  tabIndex="0"
                >
                  <ScheduledOrderDetailSummary {...props} scheduledOrderInfo={scheduledOrderInfo} />
                </div>
              </Card>
            )}
          </Styled>
        ),
        [goToPage, itemId, props, scheduledOrderInfo]
      )}
    </>
  );
};

export default ProfileScheduledOrder;
