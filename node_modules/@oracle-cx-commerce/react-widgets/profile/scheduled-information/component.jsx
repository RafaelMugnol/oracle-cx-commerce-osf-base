/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */
import React, {useContext} from 'react';
import {OrderContext} from '@oracle-cx-commerce/react-ui/contexts';
import {isEmptyObject} from '@oracle-cx-commerce/utils/generic';
import Styled from '@oracle-cx-commerce/react-components/styled';
import Card from '@oracle-cx-commerce/react-components/card';
import css from '@oracle-cx-commerce/react-widgets/profile/scheduled-information/styles.css';
import Link from '@oracle-cx-commerce/react-components/link';
import ScheduledDetails from '@oracle-cx-commerce/react-widgets/profile/scheduled-information/components/scheduled-details';

/**
 * Following component display Scheduled Order information shopper selected.
 *
 * @param props
 */

const ScheduledInformation = props => {
  const {headingScheduleDetails, labelEdit, showEditLink = false} = props;
  const {scheduleInfo = {}} = useContext(OrderContext);
  const SHIPPING_ADDRESS_URL = 'checkout-shipping';

  //Method to check if schedule info available is valid
  const isScheduledInfoValid = () => {
    let isValid = false;
    if (scheduleInfo.name && scheduleInfo.startDate && scheduleInfo.schedule) isValid = true;

    return isValid;
  };

  // If schedule info is empty, doesn't render anything
  if (isEmptyObject(scheduleInfo)) {
    return null;
  }

  return (
    <Styled id="ScheduledInformation" css={css}>
      <div className="ScheduledInformation">
        <div className="ScheduledInformation__HeadingContainer">
          <h2>{headingScheduleDetails}</h2>
          {showEditLink && (
            <div className="ScheduledInformation__EditSchedule">
              <Link href={SHIPPING_ADDRESS_URL}>{labelEdit}</Link>
            </div>
          )}
        </div>
        <Card className="ScheduledInformation__Card">
          <div className="ScheduledInformation__Details">
            {isScheduledInfoValid() && <ScheduledDetails scheduleInfo={scheduleInfo} {...props} />}
          </div>
        </Card>
      </div>
    </Styled>
  );
};

export default ScheduledInformation;
