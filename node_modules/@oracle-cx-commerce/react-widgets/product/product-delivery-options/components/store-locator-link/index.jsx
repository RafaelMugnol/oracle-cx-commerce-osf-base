/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import React, {useCallback} from 'react';
import Styled from '@oracle-cx-commerce/react-components/styled';
import css from '@oracle-cx-commerce/react-widgets/product/product-delivery-options/components/store-locator-link/styles.css';

const StoreLocatorLink = props => {
  const {
    actionChangeStore,
    actionSelectStore,
    selectedStore = {},
    setStoreSettings,
    storeLocatorLinkRef,
    'data-testid': dataTestId = ''
  } = props;

  /**
   * Displays the Store Locator modal.
   */
  const showStoreLocatorOverlay = useCallback(() => {
    setStoreSettings(prevState => {
      return {
        ...prevState,
        displayStoreSelectorModal: true
      };
    });
  }, [setStoreSettings]);

  return (
    <Styled id="StoreLocatorLink" css={css}>
      <span
        role="link"
        ref={storeLocatorLinkRef}
        data-testid={dataTestId}
        aria-label={selectedStore.locationId ? actionChangeStore : actionSelectStore}
        onKeyDown={event => {
          if (event.key === 'Enter') {
            showStoreLocatorOverlay(event);
          }
        }}
        tabIndex="0"
        onClick={showStoreLocatorOverlay}
        className="StoreLocatorLink"
      >
        {selectedStore.locationId ? actionChangeStore : actionSelectStore}
      </span>
    </Styled>
  );
};

export default React.memo(StoreLocatorLink);
