/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import React, {useRef} from 'react';
import Modal from '@oracle-cx-commerce/react-components/modal';
import Styled from '@oracle-cx-commerce/react-components/styled';
import css from '@oracle-cx-commerce/react-widgets/checkout/request-quote-button/components/request-quote-modal/styles.css';
import OrderItemDetails from '@oracle-cx-commerce/react-widgets/profile/shipping-information/components/order-item-details';
// import PropTypes from 'prop-types';

/**
 * Component to display a modal for request quote.
 * @param {Object} props the properties object
 */
const RequestQuoteModal = props => {
  const {id, cssOverride, showRequestQuote, setShowRequestQuote, onSubmit, currentOrder} = props;
  const {
    textAddNotes,
    headingRequestQuote,
    actionRequestQuote,
    closeLinkAltText,
    actionCancel,
    displayItemsInQuoteModal,
    addNotesMaxText
  } = props;
  const {shippingGroups, commerceItems} = currentOrder;
  const requestQuoteNoteRef = useRef({});

  const onClick = () => {
    onSubmit(requestQuoteNoteRef.current.value);
  };

  return (
    <Styled id="RequestQuoteModal" css={css}>
      <Modal
        show={showRequestQuote}
        onClose={() => setShowRequestQuote(false)}
        className={'RequestQuoteModal__Modal'}
        closeIconTitle={closeLinkAltText}
        closeArialLabel={closeLinkAltText}
        cssOverride={cssOverride}
        title={<span className="RequestQuoteModal__ModalHeaderText">{headingRequestQuote}</span>}
      >
        <div className="RequestQuoteModal__ModalBody">
          <div className="RequestQuoteModal__Items">
            {displayItemsInQuoteModal &&
              (Object.keys(shippingGroups || {}) || []).map(shippingGroupId => (
                <div key={shippingGroupId}>
                  <OrderItemDetails
                    shippingGroup={shippingGroups[shippingGroupId]}
                    commerceItems={commerceItems}
                    shippingGroupId={shippingGroupId}
                    {...props}
                  />
                </div>
              ))}
          </div>
          <div className="RequestQuoteModal__Notes">
            <p>
              {textAddNotes}
              <span>({addNotesMaxText})</span>
            </p>
            <textarea
              ref={requestQuoteNoteRef}
              id={`notes-${id}`}
              type="text"
              rows="4"
              maxLength="1000"
              name="requestQuoteNote"
              placeholder={textAddNotes}
              aria-label={textAddNotes}
            />
          </div>
          <div className="RequestQuoteModal__Actions">
            <button
              type="submit"
              className="RequestQuoteModal__SaveButton"
              aria-label={actionRequestQuote}
              onClick={onClick}
            >
              {actionRequestQuote}
            </button>
            <button
              type="button"
              className="secondary RequestQuoteModal__CancelButton"
              aria-label={actionCancel}
              onClick={() => setShowRequestQuote(false)}
            >
              {actionCancel}
            </button>
          </div>
        </div>
      </Modal>
    </Styled>
  );
};

RequestQuoteModal.propTypes = {};

RequestQuoteModal.defaultProps = {};

export default React.memo(RequestQuoteModal);
