/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {CheckoutShippingContext} from '@oracle-cx-commerce/react-widgets/checkout/checkout-shipping-container/context';
import React, {useContext} from 'react';
import Styled from '@oracle-cx-commerce/react-components/styled';
import css from '@oracle-cx-commerce/react-widgets/checkout/checkout-multi-shipping-details/components/multi-shipping-link/styles.css';
import {noop} from '@oracle-cx-commerce/utils/generic';

/**
 * Component that displays the link to split the items to multiple addresses
 * @param props
 */

export const MultiShippingLink = props => {
  //resources
  const {actionShipItemsToMultipleAddresses} = props;

  // Checkout Shipping Context
  const {
    checkoutShippingTabs = {},
    setShippingStatus = noop,
    setDeliveryAddressForm = noop
  } = useContext(CheckoutShippingContext);

  /**
   * Click handler function for the 'Ship items to multiple addresses' link
   * Modifies the shipping tab index to display the multi shipping edit screen
   */
  const handleClick = () => {
    setShippingStatus(prevState => {
      return {
        ...prevState,
        tabIndex: checkoutShippingTabs.MULTI_SHIPPING_EDIT_TAB_INDEX,
        showConinueToPayment: false,
        enableContinue: false
      };
    });
    setDeliveryAddressForm(prevState => {
      return {...prevState, isModified: false};
    });
  };

  return (
    <Styled id="MultiShippingLink" css={css}>
      <div className="MultiShippingLink__Wrapper">
        <button type="button" className="MultiShippingLink__Text" onClick={handleClick}>
          {actionShipItemsToMultipleAddresses}
        </button>
      </div>
    </Styled>
  );
};
