/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */
import React, {useEffect} from 'react';
import StyleTable from './style-table';

const Style = props => {
  const {componentsInfo = null, styles, styleComponentName = '', componentSubCategoryMap, basePageURL, name} = props;

  const upperCaseName = name ? name[0].toUpperCase() + name.substring(1) : null;
  function findPos(obj) {
    let curtop = 0;
    if (obj.offsetParent) {
      do {
        curtop += obj.offsetTop;
      } while ((obj = obj.offsetParent));

      return [curtop];
    }
  }
  useEffect(() => {
    if (styleComponentName) {
      window.scroll(0, findPos(document.querySelector(`#${styleComponentName}`)));
    }
  });

  //Handle Component section separately
  if (componentsInfo) {
    return (
      <div className="sub-block">
        <div className="sub-details">
          <div className="schema-intro-details">
            {Object.keys(componentsInfo).map(function (subCat) {
              return (
                <div key={subCat}>
                  {componentsInfo[subCat].length ? (
                    <>
                      <ul>
                        {componentsInfo[subCat].map(componentdetails => (
                          <li key={componentdetails.name} id={componentdetails.name}>
                            <h2> {componentdetails.name}</h2>
                            <a
                              href={`${basePageURL}#components/${componentSubCategoryMap.get(componentdetails.name)}/${
                                componentdetails.name
                              }`}
                            >
                              {componentdetails.name}
                            </a>
                            <table id="styleTable" className="styleTable">
                              <tbody>
                                <StyleTable key="styleTable" styles={componentdetails.styles} />
                              </tbody>
                            </table>
                          </li>
                        ))}
                      </ul>
                    </>
                  ) : (
                    ''
                  )}
                </div>
              );
            })}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="sub-block">
      <div className="sub-details">
        <div className="schema-intro-details">
          <h2>{upperCaseName}</h2>
          <table id="styleTable" className="styleTable">
            <tbody>
              <StyleTable key="styleTable" styles={styles} />
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
};
export default Style;
