/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {
  CollectionNavCardContext,
  CollectionNavContext
} from '@oracle-cx-commerce/react-widgets/category/collection-navigation/context';
import React, {useContext} from 'react';

import ChildCategory from '@oracle-cx-commerce/react-widgets/category/collection-navigation/components/child-category';
import {StoreContext} from '@oracle-cx-commerce/react-ui/contexts';
import ViewAllLink from '@oracle-cx-commerce/react-widgets/category/collection-navigation/components/view-all-link';
import {getCategories} from '@oracle-cx-commerce/commerce-utils/selector';

/**
 * Represents a list of child collections.
 */
const ChildCollectionListing = () => {
  const {shouldHideChildCategoryIndicator} = useContext(CollectionNavContext);

  const {
    category: {childCategories = [], route}
  } = useContext(CollectionNavCardContext);
  const store = useContext(StoreContext);

  const categories = getCategories(store.getState());

  return (
    <React.Fragment>
      <ul className="CollectionNavigation__Nav" role="menu">
        {childCategories.map(({id}) => (
          <ChildCategory
            key={id}
            category={categories[id]}
            hideChildCategories={shouldHideChildCategoryIndicator(id)}
          />
        ))}
        <ViewAllLink route={route} />
      </ul>
    </React.Fragment>
  );
};

ChildCollectionListing.propTypes = {};

ChildCollectionListing.defaultProps = {};

export default React.memo(ChildCollectionListing);
