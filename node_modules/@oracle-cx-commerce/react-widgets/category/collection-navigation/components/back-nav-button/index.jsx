/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {
  CollectionNavCardContext,
  CollectionNavContext
} from '@oracle-cx-commerce/react-widgets/category/collection-navigation/context';
import React, {useCallback, useContext} from 'react';

import BackIcon from '@oracle-cx-commerce/react-components/icons/back';

/**
 * Back Navigation button - Text is the name of the previous category
 */
const BackNavButton = () => {
  const {getParentCategoryDisplayName} = useContext(CollectionNavContext);

  const {
    index,
    isVisible,
    category: {id}
  } = useContext(CollectionNavCardContext);

  const handleKeyDown = useCallback(e => {
    e.key === 'Enter' && e.target.click();
  }, []);

  const text = getParentCategoryDisplayName(id);

  return (
    <React.Fragment>
      {text && (
        <div className="CollectionNavigation__BackNavItem">
          {/* eslint-disable-next-line jsx-a11y/label-has-associated-control*/}
          <label
            {...(id ? {htmlFor: `CollectionNavigation_ChildCard--${id}`} : {})}
            tabIndex={isVisible(index) ? 0 : -1}
            onKeyDown={handleKeyDown}
            // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role
            role="button"
            aria-label={text}
          >
            <BackIcon className="CollectionNavigation__BackIcon" role="none" />
            <span aria-hidden="true">{text}</span>
          </label>
        </div>
      )}
    </React.Fragment>
  );
};

BackNavButton.propTypes = {};

BackNavButton.defaultProps = {};

export default BackNavButton;
