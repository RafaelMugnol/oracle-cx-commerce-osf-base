/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {useEffect} from 'react';
import {fetchAllSites} from '@oracle-cx-commerce/fetchers/site';
import {isEmptyObject} from '@oracle-cx-commerce/utils/generic';
import {getSites} from '@oracle-cx-commerce/commerce-utils/selector';

export default store =>
  useEffect(() => {
    const sites = getSites(store.getState());

    if (isEmptyObject(sites)) {
      // Fetch all sites if they aren't already present in the state
      fetchAllSites(store);
    }
  }, [store]);
