/*
 ** Copyright (c) 2020 Oracle and/or its affiliates.
 */

import {useEffect} from 'react';
import {fetchShopperSettings} from '@oracle-cx-commerce/fetchers/merchant-settings';
import {getShopperSettings, getPasswordPolicies} from '@oracle-cx-commerce/commerce-utils/selector';
import {isEmptyObject} from '@oracle-cx-commerce/utils/generic';

export default store =>
  // invoke fetcher if server-side rendering isn't executed
  useEffect(() => {
    const shopperSettings = getShopperSettings(store.getState());
    const passwordPolicies = getPasswordPolicies(store.getState());
    if (isEmptyObject(shopperSettings) || isEmptyObject(passwordPolicies)) {
      fetchShopperSettings(store);
    }
  }, [store]);
