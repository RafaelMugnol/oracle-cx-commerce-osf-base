/*
 ** Copyright (c) 2021 Oracle and/or its affiliates.
 */

import {getAPMSettings, getApmUserName, getSiteName} from '@oracle-cx-commerce/subscribers/apm/selectors';

export const APMRUM_JS_STATIC_PATH = '/static/jslib/apmrum.min.js';

/**
 * It adds script tag with default APM settings which are existing in site settings.
 * @param {*} state
 * @returns
 */
export const addAPMDefaultConfig = state => {
  const {ociApm: apmSettings} = getAPMSettings(state);

  window.apmrum = window.apmrum || {};
  window.apmrum.serviceName = apmSettings.content.serviceName;
  window.apmrum.webApplication = getSiteName(state);
  window.apmrum.ociDataUploadEndpoint = apmSettings.content.dataUploadEndpoint;
  window.apmrum.OracleAPMPublicDataKey = apmSettings.content.publicKey;
  window.apmrum.username = getApmUserName(state);
};

/**
 * It updates visitor ID as user name in APM RUM settings.
 *
 * @param {*} state
 */
export const updateUserName = state => {
  if (window && window.apmrum) {
    window.apmrum.username = getApmUserName(state);
  }
};
